{% extends "base.html" %}

{% block title %}{{ board.board_title }} - ììœ ê²Œì‹œíŒ{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for(request, 'static', path='/css/freeboardDetail.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- ê²Œì‹œê¸€ ë‚´ìš© -->
    <article class="board-article">
        <div class="article-header">
            <h1 class="article-title">{{ board.board_title }}</h1>
            
            <div class="article-meta">
                <div class="author-info">
                    {% if board.author.profile_img %}
                        <img src="/uploads{{ board.author.profile_img }}" alt="í”„ë¡œí•„" class="author-profile">
                    {% else %}
                        <div class="author-profile" style="background:#ddd;display:flex;align-items:center;justify-content:center;">ğŸ‘¤</div>
                    {% endif %}
                    <div class="author-details">
                        <span class="author-name">{{ board.author.member_nickname }}</span>
                        <span class="author-level">Level {{ board.author.member_level_no }}</span>
                    </div>
                </div>

                <div class="article-stats">
                    <div class="stat-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>{{ board.b_create_date.strftime('%Y.%m.%d %H:%M') }}</span>
                    </div>
                    {% if board.b_update_date %}
                    <div class="stat-item">
                        <span>(ìˆ˜ì •ë¨)</span>
                    </div>
                    {% endif %}
                    <div class="stat-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            <path d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                        </svg>
                        <span>{{ board.board_count }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë³¸ë¬¸ -->
        <div class="article-content">
            {{ board.board_content | safe }}
        </div>

        <!-- ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ -->
        {% if images %}
        <div class="article-images">
            {% for image_url in images %}
            <div class="image-item">
                <img src="{{ image_url }}" alt="ê²Œì‹œê¸€ ì´ë¯¸ì§€">
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- ê²Œì‹œê¸€ ì•¡ì…˜ -->
        <div class="article-actions">
            <!-- ì¢‹ì•„ìš” ë²„íŠ¼ -->
            <button class="btn-like {% if is_liked %}liked{% endif %}" 
                    onclick="toggleLike({{ board.board_no }})" 
                    id="likeBtn">
                <svg viewBox="0 0 24 24" fill="{% if is_liked %}currentColor{% else %}none{% endif %}" stroke="currentColor" stroke-width="2">
                    <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                <span class="like-count" id="likeCount">{{ like_count }}</span>
            </button>

            <!-- ëª©ë¡ ë²„íŠ¼ -->
            <button class="btn-list" onclick="location.href='{{ url_for(request, 'board_list') }}'">ëª©ë¡</button>

            <!-- ì‘ì„±ì ì „ìš© ë²„íŠ¼ -->
            {% if is_author %}
            <button class="btn-edit" onclick="location.href='/board/update/{{ board.board_no }}'">ìˆ˜ì •</button>
            <button class="btn-delete" onclick="deleteBoard({{ board.board_no }})">ì‚­ì œ</button>
            {% endif %}
        </div>
    </article>

    <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
    <section class="comment-section">
        <h3 class="comment-title">
            ëŒ“ê¸€ <span class="comment-count">{{ comment_count }}</span>
        </h3>

        <!-- ëŒ“ê¸€ ì‘ì„± (ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ) -->
        {% if current_user %}
        <div class="comment-write">
            <form onsubmit="submitComment(event, {{ board.board_no }})">
                <textarea id="commentInput" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." rows="3" required></textarea>
                <div class="comment-write-actions">
                    <label>
                        <input type="checkbox" id="secretCheck">
                        ë¹„ë°€ëŒ“ê¸€
                    </label>
                    <button type="submit" class="btn-submit">ëŒ“ê¸€ ì‘ì„±</button>
                </div>
            </form>
        </div>
        {% else %}
        <div class="comment-write">
            <p class="login-required">ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ <a href="/auth/login">ë¡œê·¸ì¸</a>ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </div>
        {% endif %}

        <!-- ëŒ“ê¸€ ëª©ë¡ (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„) -->
        <div class="comment-list">
            <p class="comment-placeholder">ëŒ“ê¸€ ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤.</p>
        </div>
    </section>
</div>
{% endblock %}

{% block extra_js %}
<script>
// ì¢‹ì•„ìš” í† ê¸€ (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ API ì—°ë™)
function toggleLike(boardNo) {
    alert('ì¢‹ì•„ìš” ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤.');
}

// ê²Œì‹œê¸€ ì‚­ì œ (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ API ì—°ë™)
function deleteBoard(boardNo) {
    if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        alert('ì‚­ì œ ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤.');
    }
}

// ëŒ“ê¸€ ì‘ì„± (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ API ì—°ë™)
function submitComment(event, boardNo) {
    event.preventDefault();
    alert('ëŒ“ê¸€ ì‘ì„± ê¸°ëŠ¥ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤.');
}
</script>
{% endblock %}